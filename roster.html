<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMS Documentation</title>
    <link rel="stylesheet" href="test.css">
</head>
<body>

<div class="header">
    <div class="header-left">
        <img src="MZMC2.png" alt="Mount Zonah Medical Center Logo" class="header-logo">
        <div class="title-container">
            <div class="title">Mount Zonah Medical Center</div>
            <div class="mission-statement">
                <p>What we stand for:</p>
                <p>Quality Performance, Quick Response, Constant Professionalism, Commitment to save lives</p>
            </div>
        </div>
    </div>
    <nav class="header-menu">
        <a href="index.html">Home</a>
        <a href="coe.html">Code Of Ethics</a>
        <a href="codes.html">Radio 10 Codes</a>
        <a href="medicalprocedures.html">Medical Procedures</a>
        <a href="transportreport.html">Transport Reports</a>
        <a href="orreport.html">Operating Room Reports</a>
        <a href="roster.html">Roster</a>
        <a href="feedback.html">Feedback</a>
    </nav>
</div>

<div class="main-content">
    <!-- EMS Roster Data will be dynamically loaded here -->
</div>

<script>
function displayData(data) {
    const container = document.querySelector('.main-content');
    container.innerHTML = ''; // Clear existing content

    data.forEach(entry => {
        if (entry['Name'] && entry['Name'] !== '') {
            const div = document.createElement('div');
            div.className = 'ems-entry';

            const callSignSpan = document.createElement('span');
            callSignSpan.className = 'ems-data';
            callSignSpan.textContent = `Call Sign: ${entry['Call Sign']}`;
            div.appendChild(callSignSpan);

            const nameSpan = document.createElement('span');
            nameSpan.className = 'ems-data';
            nameSpan.textContent = `Name: ${entry['Name']}`;
            div.appendChild(nameSpan);

            const positionSpan = document.createElement('span');
            positionSpan.className = 'ems-data';
            positionSpan.textContent = `Position: ${entry['Position']}`;
            div.appendChild(positionSpan);

            if (entry['LOA'] && entry['LOA'] !== '') {
                const loaSpan = document.createElement('span');
                loaSpan.className = 'ems-data';
                loaSpan.textContent = `LOA: ${entry['LOA']}`;
                div.appendChild(loaSpan);
            }

            if (entry['Medivac'] && entry['Medivac'] !== '') {
                const medivacSpan = document.createElement('span');
                medivacSpan.className = 'ems-data';
                medivacSpan.textContent = `Medivac: ${entry['Medivac']}`;
                div.appendChild(medivacSpan);
            }

            if (entry['Supervisor'] && entry['Supervisor'] !== '') {
                const supervisorSpan = document.createElement('span');
                supervisorSpan.className = 'ems-data';
                supervisorSpan.textContent = `Supervisor: ${entry['Supervisor']}`;
                div.appendChild(supervisorSpan);
            }

            if (entry['Medivac Trainer'] && entry['Medivac Trainer'] !== '') {
                const trainerSpan = document.createElement('span');
                trainerSpan.className = 'ems-data';
                trainerSpan.textContent = `Medivac Trainer: ${entry['Medivac Trainer']}`;
                div.appendChild(trainerSpan);
            }

            container.appendChild(div);
        }
    });
}

function processGoogleSheetData(sheetData) {
    const headers = sheetData[0]; // First row is headers
    const rows = sheetData.slice(1); // Remaining rows are data

    const parsedData = rows.map(row => {
        let entry = {};
        headers.forEach((header, index) => {
            entry[header.trim()] = row[index] ? row[index].trim() : '';
        });
        return entry;
    });

    displayData(parsedData);
}

// Fetch the Google Sheet content and display it!
const sheetId = '1lIMalwbeIYr_-331UK8lMK3v_aHkXGwpgBJsJ3DYh2E'; // Replace with your Google Sheet ID
const apiKey = 'AIzaSyDlrEnIOC9tzQ9fq-TftSZhGZqbVnx-DzY'; // Replace with your Google API key
const range = 'Sheet1!A1:N84'; // Adjust the range as needed

const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

fetch(url)
    .then(response => response.json())
    .then(data => {
        processGoogleSheetData(data.values);
    })
    .catch(error => {
        console.error('Error fetching Google Sheet data:', error);
    });
</script>

</body>
</html>
